clear all;
close all;
clc;

s0 = 0.95631246;          %initial proportion of Susceptible
e0 = 3.6448*(10^(-02));   %initial proportion of Exposed
a0 = 3.0487*(10^(-03));   %initial proportion of Infected
q0 = 1.2195*(10^(-03));   %initial proportion of Quarantined
r0 = 2.9709*(10^(-03));   %initial proportion of Recovered

s1=-0.0000511695702;
e1=-0.003041596679;
a1=0.002571287732;
q1=0.0005268159560;
r1=0.00002146194700;

s2=-(0.02390781150*a1 + 0.02390781150*q1 + 0.0001267050000*s1);
e2=-(-0.02390781150*a1 - 0.02390781150*q1 - 0.0001067050000*s1 + 0.08625*e1);
a2=-(-0.07142*e1 + 0.01044*a1);
q2=-(-0.01430*e1 - 0.00288*a1 + 0.00260*q1);
r2=-(-0.00025*a1 - 0.00051*e1 - 0.00178*q1 + 0.00002*r1);

s3=-(0.02390781150*a2 + 0.02390781150*q2 + 0.02500*s1*(a1 + q1) + 0.0001267050000*s2);
e3=-(-0.02390781150*a2 - 0.02390781150*q2 - 0.02500*s1*(a1 + q1) - 0.0001067050000*s2 + 0.08625*e2);
a3=-(-0.07142*e2 + 0.01044*a2);
q3=-(-0.01430*e2 - 0.00288*a2 + 0.00260*q2);
r3=-(-0.00025*a2 - 0.00051*e2 - 0.00178*q2 + 0.00002*r2);

s4=-(0.02390781150*a3 + 0.02390781150*q3 + 0.02500*s1*(a2 + q2) + 0.02500*s2*(a1 + q1) + 0.0001267050000*s3);
e4=-(-0.02390781150*a3 - 0.02390781150*q3 - 0.02500*s1*(a2 + q2) - 0.02500*s2*(a1 + q1) - 0.0001067050000*s3 + 0.08625*e3);
a4=-(-0.07142*e3 + 0.01044*a3);
q4=-(-0.01430*e3 - 0.00288*a3 + 0.00260*q3);
r4=-(-0.00025*a3 - 0.00051*e3 - 0.00178*q3 + 0.00002*r3);

t=0;
for i=1:1500
    t=t+0.01;
    s(i)=s0+(s1*t)+(s2*(t^2)/2)+(s3*(t^3)/6)+(s4*(t^4)/24);
    e(i)=e0+(e1*t)+(e2*(t^2)/2)+(e3*(t^3)/6)+(e4*(t^4)/24);
    a(i)=a0+(a1*t)+(a2*(t^2)/2)+(a3*(t^3)/6)+(a4*(t^4)/24);
    q(i)=q0+(q1*t)+(q2*(t^2)/2)+(q3*(t^3)/6)+(q4*(t^4)/24);
    r(i)=r0+(r1*t)+(r2*(t^2)/2)+(r3*(t^3)/6)+(r4*(t^4)/24);
    
    fprintf('S(%.1f)= %.6f\n',i,s(i));
    fprintf('E(%.1f)= %.6f\n',i,e(i));
    fprintf('I(%.1f)= %.6f\n',i,a(i));
    fprintf('Q(%.1f)= %.6f\n',i,q(i));
    fprintf('R(%.1f)= %.6f\n',i,r(i));
end