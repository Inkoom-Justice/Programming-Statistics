clear all;
clc;
t=0;
for i=1:200
    t=t+1;
s0 = 7/2 - (127184377/50000000)*exp(-(1/50000)*t);
e0 = (1139/31250)*exp(-(69/800)*t);
a0 = (30487/10000000)*exp(-(261/25000)*t);
q0 = (2439/2000000)*exp(-(261/100000)*t);
r0 = (29709/10000000)*exp(-(1/50000)*t);

s1 = ((213409/8336000)*exp(-(521/50000)*t) - (3877470101599/208800000000000)*exp(-(261/25000)*t) - (34466966167/1160000000000)*exp(-(261/100000)*t) + (2439/59200)*exp(-(259/100000)*t) - (74531826777249457/4025037600000000000))*exp(-(1/50000)*t);
e1 = 5691/4460800*exp(-261/100000*t) - 310202695503/334480000000000*exp(-263/100000*t) - 3877470101599/1515800000000000*exp(-523/50000*t) + 30487/8664000*exp(-261/25000*t) - 12525628603579148031427/9567826705179600000000000*exp(-69/800*t);
a1 = -4067369/118453125*exp(-69/800*t) + 4067369/118453125*exp(-261/25000*t);
q1 = -9581/1537500*exp(-69/800*t) - 30487/27187500*exp(-261/25000*t) + 683016/92890625*exp(-261/100000*t);
r1 = -58089/269468750*exp(-69/800*t) - 30487/416800000*exp(-261/25000*t) - 217071/259000000*exp(-261/100000*t) + 1048920814591/930863197600000*exp(-1/50000*t);

s2 = (-788104451/19144353450*exp(-8623/100000*t) + 96739488693/321509516800000*exp(-1303/100000*t) + 929457169/9936512000000*exp(-1043/50000*t) + 2282033371/8181523500*exp(-521/50000*t) - 118212430987448713/1743897600000000000000*exp(-261/12500*t) - 1050794397533329/4844160000000000000*exp(-261/20000*t) - 8599565304525637118382401593/42475223583475200000000000000*exp(-261/25000*t) - 9340547831257/53824000000000000*exp(-261/50000*t) - 686733235203517393411127/3828615765120000000000000*exp(-261/100000*t) + 1366032/5499125*exp(-259/100000*t) + 100234573611362027/3351038906250000000*exp(-69/800*t) + 5948721/24627200000*exp(-13/2500*t) - 2262088368016273773487172215757789699/16827542105219399980108800000000000000)*exp(-1/50000*t);
e2 = (-788104451/222015000000*t - 1050794397533329/27164416000000000000*exp(3659/50000*t) + 1982907/127919360000*exp(8103/100000*t) - 686733235203517393411127/122662394743040000000000000*exp(4181/50000*t) + 32246496231/602059264000000*exp(183/2500*t) + 796852/103591625*exp(2091/25000*t) - 118212430987448713/5458032000000000000000*exp(1307/20000*t) + 6506200183/217969728000000*exp(6537/100000*t) - 8599565304525637118382401593/308352221780803200000000000000*exp(7579/100000*t) + 2282033371/59524116750*exp(7581/100000*t) - 84064930481313/7517728000000000000*exp(8101/100000*t) - 100234573611362027/777052500000000*exp(-1/50000*t) + 213401164850965605807037227415712950661961001578680668417/1654519629381831089216118156358371197808000000000000000)*exp(-69/800*t);
a2 = (4555810841/391500000000*exp(783/100000*t) - 6623617709/781000000000*exp(781/100000*t) + 1826948903/200000000*exp(-1/50000*t) + 628284147/2500000000000*t + 164032997/133000000000*exp(-7581/100000*t) - 743309131720965151/81332559000000000)*exp(-261/25000*t);
q2 = (364873117/20000000000000*t + 294030847/209100000000*exp(-2091/25000*t) - 17150651/900000000*exp(-783/100000*t) + 1828995331/392500000000*exp(-157/20000*t) + 132620741/200000000*exp(-1/50000*t) - 3201356962505651/4924305000000000)*exp(-261/100000*t);
r2 = 254301927/1077875000000*exp(-69/800*t) - 8382915401/10420000000000*exp(-261/25000*t) + 326149517/2610000000000*exp(-523/50000*t) + 16423023/90625000000*exp(-263/100000*t) - 137388199/25900000000*exp(-261/100000*t) + 169065181831494161867/30369411821700000000000*exp(-1/50000*t);

S(t)=s0+s1+s2;
E(t)=e0+e1+e2;
I(t)=a0+a1+a2;
Q(t)=q0+q1+q2;
R(t)=r0+r1+r2;

    fprintf('S(%.1f)= %.6f\n',t,S(t));
    fprintf('E(%.1f)= %.6f\n',t,E(t));
    fprintf('I(%.1f)= %.6f\n',t,I(t));
    fprintf('Q(%.1f)= %.6f\n',t,Q(t));
    fprintf('R(%.1f)= %.6f\n',t,R(t));

xx(i)=i;
end

plot(xx,S(1:i),xx,E(1:i),xx,I(1:i),xx,Q(1:i),xx,R(1:i));
hold on
xlabel('Time/days')
ylabel('SEIQR')
legend('Susceptible','Exposed','Infected','Quarantined','Recovered')


